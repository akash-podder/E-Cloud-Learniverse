# ------------------------
# Postgres Deployment Object
# ------------------------
apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgres
  labels:
    # ðŸ‘ˆ Any KEY-VALUE pair is ACCEPTABLE here, convention is to use "app: fastapi-e-cloud-deployment"
    # But I am using "messi-db-app:" Key so that, I can show ANY CUSTOM KEY-VALUE pair can be Given
    messi-db-app: postgres-e-cloud-deployment

spec:
  replicas: 1
  selector:
    matchLabels:
      # "messi-db-app: postgres-e-cloud-pod" ðŸ‘ˆ this KEY-VALUE Pair Must match the Below Pod's KEY-VALUE Pair
      messi-db-app: postgres-e-cloud-pod

  # This section defines the Pod template (metadata + spec)
  template:
    metadata:
      labels:
        messi-db-app: postgres-e-cloud-pod # ðŸ‘ˆ this Must Match with "matchLabels" KEY-VALUE pair
    spec:
      containers:
        - name: my-postgres-pod
          image: postgres:17             # Use local image if available
          imagePullPolicy: IfNotPresent  # Use local image if exists, otherwise pull
          env:
            - name: POSTGRES_USER
              value: "postgres"
            - name: POSTGRES_PASSWORD
              value: "postgres"
            - name: POSTGRES_DB
              value: "e_cloud_learniverse_db"
          ports:
            - containerPort: 5432